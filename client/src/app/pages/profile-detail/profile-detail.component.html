<ng-container *ngIf="!pageLoading && !!visitedUser; else pageLoader">
  <!-- Шапка -->
  <app-main-menu [autoCollapse]="true"
                 [imageFullShow]="true"
                 [type]="navMenuType"
                 [image]="imagePrefix + backgroundImageData[navMenuType === navMenuTypes.full? 'imageName': 'imageNameShort']"
                 [imagePositionX]="backgroundImageData.positionX"
                 [imagePositionY]="backgroundImageData.positionY"
                 [imageOverlay]="backgroundImageData.imageOverlay"
                 [title]="title"
                 [subTitle]="subTitle"
                 [avatarImage]="menuAvatarImage"
                 [avatarIcon]="menuAvatarIcon"
                 [floatButtonIcon]="floatButtonIcon"
                 [floatButtonLink]="floatButtonLink"
                 [backButtonLink]="backButtonLink"></app-main-menu>

  <!-- Контейнер с данными -->
  <div class="root-section"
       [ngClass]="{ center: !userHasAccess }">
    <!-- Данные о пользователе -->
    <ng-container *ngIf="userHasAccess; else AccessDeniedByPrivate">
      <!-- Сведения аккаунта -->
      <div class="section">
        <div class="container">
          <div class="information with-ava">
            <!-- Аватарка -->
            <div class="information__avatar">
              <app-user-avatar [user]="visitedUser"
                               [itsMyPage]="itsMyPage"></app-user-avatar>
            </div>
            <!-- Сведения -->
            <div class="information__data">
              <!-- Статус пользователя -->
              <div class="information__data-item"
                   *ngIf="!!visitedUser.pageStatus?.length || itsMyPage">
                <app-user-status [user]="visitedUser"
                                 [itsMyPage]="itsMyPage"></app-user-status>
              </div>
              <!-- Остальные сведения -->
              <div class="information__data-item">
                <app-card title="Общие данные">
                  <div content>123</div>
                  <ng-container menus
                                *ngIf="itsMyPage">
                    <!-- Настройки персональных данных -->
                    <a mat-menu-item
                       routerLink="/profile/settings/person">
                      <mat-icon>edit</mat-icon>
                      Изменить данные
                    </a>
                  </ng-container>
                </app-card>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- Сновидения -->
      <div class="section white">
        <div class="container">
          <!-- Список сновидений -->
          <ng-container *ngIf="userHasDiaryAccess; else DiaryAccessDeniedByPrivate">
            <ng-container *ngIf="!dreamsLoading">
              <ng-container *ngIf="!!dreamsCount">
                <!-- Заголовок -->
                <app-title [type]="1"
                           [title]="itsMyPage? 'Мои сновидения': 'Сновидения пользователя'"
                           [subTitle]="dreamsCount | i18nPlural: dreamPlural">
                  <!-- Все сновидения -->
                  <a mat-stroked-button
                     color="basic"
                     routerLink="/diary/{{visitedUser.id}}">Все сны</a>
                  <!-- Новое сновидение -->
                  <a mat-flat-button
                     color="primary"
                     routerLink="/diary/editor"
                     *ngIf="itsMyPage">Новый сон</a>
                </app-title>
                <!-- Список сновидений -->
                <app-dream-list [dreams]="dreams"
                                sourcePlace="profile"
                                [oneLine]="true"
                                [showProfile]="false"></app-dream-list>
              </ng-container>
              <!-- Нет сновидений -->
              <app-inform icon="close"
                          [aboveIcon]="true"
                          title="Нет сновидений"
                          [subTitle]="itsMyPage? 'Вы еще не записали ни одного сновидения': 'ПОльзователь еще не записал ни одного сновидения'"
                          *ngIf="!dreamsCount"></app-inform>
            </ng-container>
            <!-- Лоадер сновидений -->
            <app-inform title="Загрузка сновидений"
                        subTitle="Пожалуйста подождите"
                        *ngIf="dreamsLoading"></app-inform>
          </ng-container>
        </div>
      </div>
    </ng-container>
  </div>
</ng-container>



<!-- Недоступно настройками приватности -->
<ng-template #AccessDeniedByPrivate>
  <app-inform [aboveIcon]="true"
              icon="policy"
              title="Страница недоступна"
              subTitle="Пользователь предпочел скрыть свою страницу настройками приватности"></app-inform>
</ng-template>

<!-- Недоступно настройками приватности -->
<ng-template #DiaryAccessDeniedByPrivate>
  <app-inform [aboveIcon]="true"
              icon="policy"
              title="Дневник недоступен"
              subTitle="Пользователь предпочел скрыть свой дневник сновидений настройками приватности"></app-inform>
</ng-template>



<!-- Лоадер страницы -->
<ng-template #pageLoader>
  <app-page-loader></app-page-loader>
</ng-template>
